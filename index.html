<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="style.css">

    <title>Mini Project</title>
       <!-- Visitor Analytics Tracking Script - Connects to Streamlit -->
<script>
(function() {
    // Generate a visitor ID if one doesn't exist
    function generateVisitorId() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            const r = Math.random() * 16 | 0;
            const v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    }
    
    // Wait for page to load
    window.addEventListener('load', function() {
        try {
            // Get or create visitor ID
            let visitorId = localStorage.getItem('visitor_id');
            if (!visitorId) {
                visitorId = generateVisitorId();
                localStorage.setItem('visitor_id', visitorId);
            }
            
            // Record this visit
            const visitData = {
                visitor_id: visitorId,
                timestamp: new Date().toISOString(),
                url: window.location.href,
                path: window.location.pathname,
                referrer: document.referrer || "direct",
                user_agent: navigator.userAgent,
                screen_width: screen.width,
                screen_height: screen.height
            };
            
            // Store visit in localStorage for backup
            let allVisits = JSON.parse(localStorage.getItem('site_visits') || '[]');
            allVisits.push(visitData);
            localStorage.setItem('site_visits', JSON.stringify(allVisits));
            
            // Log to console
            console.log("Visit recorded locally:", visitData);
            
            // Send data to your Streamlit app
            const streamlitUrl = "YOUR_STREAMLIT_APP_URL"; // Replace with your deployed app URL
            
            fetch(`${streamlitUrl}/api/collect`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(visitData),
            })
            .then(response => response.json())
            .then(data => {
                console.log("Visit sent to Streamlit:", data);
                
                // Add a small indicator that shows the tracking is working
                const indicator = document.createElement('div');
                indicator.style.position = 'fixed';
                indicator.style.bottom = '10px';
                indicator.style.right = '10px';
                indicator.style.background = 'rgba(0,0,0,0.5)';
                indicator.style.color = 'white';
                indicator.style.padding = '5px 10px';
                indicator.style.borderRadius = '5px';
                indicator.style.fontSize = '12px';
                indicator.style.zIndex = '9999';
                indicator.style.opacity = '0.7';
                indicator.textContent = '✓ Visit tracked';
                
                document.body.appendChild(indicator);
                
                // Hide after 3 seconds
                setTimeout(() => {
                    indicator.style.opacity = '0';
                    setTimeout(() => {
                        document.body.removeChild(indicator);
                    }, 500);
                }, 3000);
                
                // Also sync any backlogged visits
                syncStoredVisits();
            })
            .catch(error => {
                console.error("Error sending visit data:", error);
                // Keep data in localStorage for future sync
            });
            
        } catch (error) {
            console.error("Error tracking visit:", error);
        }
    });
    
    // Function to sync stored visits
    function syncStoredVisits() {
        const visits = JSON.parse(localStorage.getItem('site_visits') || '[]');
        if (visits.length > 1) { // Keep the most recent one for duplication protection
            const visitsToSync = visits.slice(0, -1);
            const streamlitUrl = "YOUR_STREAMLIT_APP_URL"; // Replace with your deployed app URL
            
            fetch(`${streamlitUrl}/api/batch-collect`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ visits: visitsToSync }),
            })
            .then(response => response.json())
            .then(data => {
                console.log("Synced visits:", data);
                // Only keep the most recent visit
                localStorage.setItem('site_visits', JSON.stringify([visits[visits.length-1]]));
            })
            .catch(error => console.error("Error syncing visits:", error));
        }
    }
})();
</script>
  </head>
  <body  onload="myFunction()" style="background-image: url('bg_img.png');">
      <ul class="topnav">
        <li ><a class="active" href="#home">Home</a></li>
        <li  ><a href="rating.html">Ratings</a></li>
        <li  ><a href="resume.html">Create Resume</a></li>
    </ul>
    

    <section class="column">
      <a href="masud.html">

      <img src="KMC.png" width="500px" height= "500px"></a>
      <div id="faraz">
        <a href="https://faraz6188.github.io/Portfolio/" >
      <img src="MFA.png" width="500px" height= "500px"></a>
    </section>
    <h1 style="color: wheat;" >A website with Simple resume generator, 5 Star Ratings & reviews and Views counter</h1>

     <!-- <h3 style="color: wheat;" > Visitors</h3>
     <h3 id="count">0</h3> -->

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script type="text/JavaScript" src="javascript.js"></script>
<!-- Visitor Analytics Script -->
<script>
(function() {
    function generateVisitorId() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            const r = Math.random() * 16 | 0;
            const v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    }
    
    function setCookie(name, value, daysToExpire) {
        const expires = new Date();
        expires.setTime(expires.getTime() + (daysToExpire * 24 * 60 * 60 * 1000));
        document.cookie = `${name}=${value}; expires=${expires.toUTCString()}; path=/`;
    }
    
    function getCookie(name) {
        const nameEQ = `${name}=`;
        const ca = document.cookie.split(';');
        for (let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) === ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }
    
    // Wait for the DOM to be fully loaded
    window.addEventListener('DOMContentLoaded', function() {
        // Get or create visitor ID
        let visitorId = getCookie('visitor_id');
        if (!visitorId) {
            visitorId = generateVisitorId();
            setCookie('visitor_id', visitorId, 30);
        }
        
        // Collect visitor data
        const visitorData = {
            visitor_id: visitorId,
            timestamp: new Date().toISOString(),
            url: window.location.href,
            referrer: document.referrer || "direct",
            user_agent: navigator.userAgent,
            screen_width: screen.width,
            screen_height: screen.height
        };
        
        // Log visitor data to console (for debugging)
        console.log("Visitor data:", visitorData);
        
        // Option 1: Send to a cloud-hosted version of your Streamlit app
        const streamlitUrl = "https://your-streamlit-app-url.com/collect";
        
        // Option 2: Send to a serverless function (recommended)
        // const analyticsEndpoint = "https://your-serverless-function-url.com/collect";
        
        // Send data to your backend
        fetch(streamlitUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(visitorData),
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Visitor data sent successfully:', data);
        })
        .catch(error => {
            console.error('Error sending visitor data:', error);
            
            // Fallback: Store data in localStorage if sending fails
            let storedVisits = JSON.parse(localStorage.getItem('visitor_analytics') || '[]');
            storedVisits.push(visitorData);
            localStorage.setItem('visitor_analytics', JSON.stringify(storedVisits));
        });
    });
})();
</script>


    <button class="info" onclick="myFunction()">Show total Views</button>

    


<footer style="color: wheat;" >
    Copyright © 2023 | Mini Project of MGM's CEN | Powered by Mohammed Faraz Ali & Khalid Masud Chaudhary
  </footer>
  </body>
</html>
